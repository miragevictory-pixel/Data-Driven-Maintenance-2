<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Maintenance Portal</title>
  <meta name="application-name" content="Maintenance Portal">
  <meta name="apple-mobile-web-app-title" content="Maintenance Portal">

  <style>
    :root{
      --brand:#9e2f1c;
      --bg:#fff9f7;
      --text:#1e1e1e;
      --muted:#6b6b6b;
      --card:#ffffff;
      --radius:18px;
      --shadow:0 6px 18px rgba(0,0,0,.12);
    }

    * , *::before, *::after{ box-sizing:border-box; }
    html,body{height:100%;}

    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "TH Sarabun New", Tahoma, sans-serif;
      color:var(--text);
      background:var(--bg);
      font-size:16px;
      line-height:1.5;
    }

    /* ====== Top Bar ====== */
    .topbar{
      position:sticky; top:0; z-index:20;
      background:var(--brand); color:#fff;
      padding:14px 18px;
      display:flex; align-items:center; gap:12px;
      box-shadow:0 2px 8px rgba(0,0,0,.15);
    }
    .topbar h1{
      font-size:20px;
      margin:0;
      font-weight:800;
      letter-spacing:.3px;
    }

    /* ✅ Back button: layer + effect */
    .back{
      appearance:none;
      border:0;
      cursor:pointer;

      width:40px;
      height:40px;
      border-radius:999px;

      display:grid;
      place-items:center;

      color:#fff;
      background: rgba(255,255,255,.14);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.18),
        0 6px 14px rgba(0,0,0,.18);

      font-size:20px;
      line-height:1;

      transition: transform .08s ease, background .15s ease, box-shadow .15s ease;
    }

    .back:hover{
      background: rgba(255,255,255,.22);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.22),
        0 10px 20px rgba(0,0,0,.22);
      transform: translateY(-1px);
    }

    .back:active{
      transform: translateY(1px) scale(.98);
      background: rgba(0,0,0,.12);
      box-shadow:
        inset 0 2px 8px rgba(0,0,0,.25),
        0 4px 10px rgba(0,0,0,.15);
    }

    .back:focus-visible{
      outline:none;
      box-shadow:
        0 0 0 3px rgba(255,255,255,.30),
        0 0 0 6px rgba(0,0,0,.12),
        inset 0 0 0 1px rgba(255,255,255,.22);
    }

    /* ✅ ทำให้ทุกหน้าบน Desktop “ไม่เล็ก” */
    .container{
      max-width: 520px;
      margin:0 auto;
      padding: 22px 18px 78px;
    }
    @media (min-width: 640px){
      .container{ max-width: 920px; }
    }
    @media (min-width: 1024px){
      .container{
        max-width: 1240px;
        padding: 28px 26px 40px;
      }
    }

    /* ====== Views ====== */
    [data-view]{display:none}
    [data-view].active{display:block}

    .card{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:22px;
      margin:18px 0;
    }
    .muted{color:var(--muted)}

    /* ====== Home ====== */
    .hero{ width:100%; text-align:center; margin: 18px 0 18px; }
    .hero span{
      font-size: 40px;
      font-weight: 900;
      color:var(--brand);
      letter-spacing:0.6px;
    }
    .big-img{
      width:100%;
      max-width:640px;
      margin: 14px auto 10px;
      display:block;
      opacity:.9
    }
    .menu{
      display:flex;
      flex-direction:column;
      gap:18px;
      margin-top:14px;
      max-width: 760px;
      margin-left:auto;
      margin-right:auto;
    }
    .btn{
      display:block;
      width:100%;
      text-align:center;
      text-decoration:none;
      cursor:pointer;
      background:var(--brand);
      color:#fff;
      border:0;
      border-radius:999px;
      padding: 14px 22px;
      font-weight:900;
      box-shadow:0 4px 0 #5f1c11, var(--shadow);
      transition:transform .05s ease;
    }
    .btn small{
      display:block;
      font-weight:700;
      font-size: 15px;
      opacity:.92;
      margin-top:2px;
    }
    .btn:active{transform:translateY(1px)}

    @media (min-width: 1024px){
      .hero span{ font-size: 46px; }
      .btn{ padding: 16px 24px; font-size: 18px; }
      .btn small{ font-size: 16px; }
    }

    /* ====== Status ====== */
    .kpi{
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:12px;
      margin: 10px 0 14px;
    }
    .kpi .box{
      background:#fff;
      border-radius:16px;
      box-shadow:var(--shadow);
      padding:16px 14px;
      text-align:center;
    }
    .kpi .box b{
      display:block;
      font-size:13px;
      color:var(--muted);
      margin-bottom:6px;
    }
    .kpi .box span{
      font-size:28px;
      font-weight:900;
      color:var(--brand);
      line-height:1;
    }

    table{
      width:100%;
      border-collapse:collapse;
      font-size:15px;
      background:#fff;
      border-radius:14px;
      overflow:hidden;
    }
    th,td{
      padding:12px 12px;
      border-bottom:1px solid #eee;
      vertical-align:top
    }
    th{
      background:#fafafa;
      text-align:left;
      color:#444;
      font-weight:800;
      font-size:14px;
    }
    [data-view="status"] .card{ overflow:auto; }

    /* ====== Footer Nav (mobile) ====== */
    .tabbar{
      position:fixed;
      bottom:14px; left:0; right:0;
      display:flex;
      justify-content:center;
      pointer-events:none
    }
    .tabbar .inner{
      pointer-events:auto;
      background:#fff;
      border-radius:999px;
      box-shadow:var(--shadow);
      display:flex;
      gap:8px;
      padding:8px
    }
    .chip{
      border-radius:999px;
      padding:8px 12px;
      border:1px solid #eee;
      background:#fff;
      font-weight:700;
      cursor:pointer;
      font-size:14px
    }
    .chip small{
      display:block;
      font-weight:500;
      font-size:11px;
      opacity:.85;
    }

    @media (min-width: 1024px){
      .tabbar{ display:none; }

      [data-view="status"] .card,
      [data-view="guide"] .card,
      [data-view="powerbi"] .card{
        max-width: 1120px;
        margin-left:auto;
        margin-right:auto;
        padding: 26px;
      }

      [data-view="guide"] .card{
        font-size:18px;
        line-height:1.7;
      }
      [data-view="guide"] h2{ font-size:24px; margin-bottom:14px; }
      [data-view="guide"] li{ margin: 10px 0; }
    }
  </style>
</head>

<body>
  <div class="topbar">
    <button class="back" aria-label="ย้อนกลับ" onclick="go('home')">⟵</button>
    <h1 id="title">Maintenance</h1>
  </div>

  <main class="container">
    <!-- HOME -->
    <section data-view="home" class="active">
      <div class="hero"><span>Maintenance</span></div>
      <div class="menu">
        <button class="btn" onclick="go('report')">แจ้งซ่อม <small>Repair request</small></button>
        <button class="btn" onclick="go('status')">สถานะการแจ้งซ่อม <small>Request status</small></button>
        <button class="btn" onclick="go('powerbi')">Power BI <small>Dashboard</small></button>
        <button class="btn" onclick="go('guide')">คู่มือการใช้งาน <small>User guide</small></button>
      </div>
    </section>

    <!-- STATUS -->
    <section data-view="status">
      <div class="kpi">
        <div class="box"><b>Scheduled</b><span id="kScheduled">0</span></div>
        <div class="box"><b>Completed</b><span id="kCompleted">0</span></div>
        <div class="box"><b>Overdue</b><span id="kOverdue">0</span></div>
      </div>

      <div class="card">
        <h3 style="margin-top:0; font-size:20px">รายการคำขอ (Request List)</h3>
        <table id="tbl">
          <thead>
            <tr>
              <th>Date</th>
              <th>Department</th>
              <th>Machine</th>
              <th>Description</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- POWER BI -->
    <section data-view="powerbi">
      <div class="card">
        <h2 style="margin:0 0 12px">Power BI Dashboard</h2>
        <p class="muted">ใส่ลิงก์ Embed ของ Power BI แทน <code>IFRAME</code></p>
        <iframe title="Overview"
          style="width:100%; aspect-ratio:16/9; border:0; background:#fafafa; border-radius:14px"
          src="https://app.powerbi.com/view?r=eyJrIjoiYWM2MDViNTEtNGU4Mi00ODVlLTk4ZmItMzgzMTg1YzdjNDUxIiwidCI6ImY5MGM0NjQ3LTg4NmYtNGI0Yy1iMmViLTU1NWRmOWVjNGU4MSIsImMiOjEwfQ%3D%3D"
          allowfullscreen></iframe>
      </div>
    </section>

    <!-- GUIDE -->
    <section data-view="guide">
      <div class="card">
        <h2 style="margin:0 0 10px">คู่มือการใช้งาน (User Guide)</h2>
        <ol>
          <li>กด “แจ้งซ่อม” ใส่รายละเอียด แล้วกดส่ง</li>
          <li>ดูรายการและนับงานใน “สถานะการแจ้งซ่อม”</li>
          <li>ฝังรายงานจริงใน “Power BI Dashboard” ด้วยลิงก์ Embed</li>
        </ol>
      </div>
    </section>
  </main>

  <div class="tabbar">
    <div class="inner">
      <button class="chip" onclick="go('home')">Home<br><small>หน้าแรก</small></button>
      <button class="chip" onclick="go('status')">สถานะ<br><small>Status</small></button>
      <button class="chip" onclick="go('powerbi')">Power BI<br><small>Dashboard</small></button>
      <button class="chip" onclick="go('guide')">คู่มือ<br><small>Guide</small></button>
    </div>
  </div>

  <script>
    const APP_NAME = 'DATA';

    const titleMap = {
      home:"Maintenance",
      status:"สถานะการแจ้งซ่อม",
      powerbi:"Power BI",
      guide:"คู่มือการใช้งาน"
    };

    function show(view){
      document.querySelectorAll('[data-view]').forEach(el=>el.classList.remove('active'));
      const el = document.querySelector(`[data-view="${view}"]`);
      if (el) el.classList.add('active');

      document.getElementById('title').textContent = titleMap[view] || 'Maintenance';
      document.title = `${titleMap[view] || 'Maintenance'} · ${APP_NAME}`;
      history.replaceState(null, '', `#${view}`);
      window.scrollTo({top:0, behavior:'smooth'});
    }
    function go(view){ show(view); }

    window.addEventListener('load', () => {
      const initial = (location.hash || '#home').slice(1);
      show(initial);
    });
  </script>
</body>
</html>
